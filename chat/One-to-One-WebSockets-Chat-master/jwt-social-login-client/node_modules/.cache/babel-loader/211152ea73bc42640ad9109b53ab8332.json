{"ast":null,"code":"import _slicedToArray from\"/home/abel/Desktop/practice/chat/One-to-One-WebSockets-Chat-master/jwt-social-login-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{Form,Input,Button,Divider,notification}from\"antd\";import{UserOutlined,LockOutlined,DingtalkOutlined,FacebookFilled}from\"@ant-design/icons\";import{login,facebookLogin}from\"../util/ApiUtil\";import\"./Signin.css\";/*global FB*/var Signin=function Signin(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),facebookLoading=_useState4[0],setFacebookLoading=_useState4[1];var _useState5=useState(localStorage.getItem(\"accessToken\")),_useState6=_slicedToArray(_useState5,2),test=_useState6[0],setTest=_useState6[1];useEffect(function(){if(localStorage.getItem(\"accessToken\")!==null){props.history.push(\"/\");}initFacebookLogin();},[]);useEffect(function(){initFacebookLogin();},[test]);var initFacebookLogin=function initFacebookLogin(){window.fbAsyncInit=function(){FB.init({appId:\"118319422120166\",autoLogAppEvents:true,xfbml:true,version:\"v7.0\"});};};var getFacebookAccessToken=function getFacebookAccessToken(){setFacebookLoading(true);FB.login(function(response){if(response.status===\"connected\"){var facebookLoginRequest={accessToken:response.authResponse.accessToken};facebookLogin(facebookLoginRequest).then(function(response){localStorage.setItem(\"accessToken\",response.accessToken);props.history.push(\"/\");setFacebookLoading(false);}).catch(function(error){if(error.status===401){notification.error({message:\"Error\",description:\"Invalid credentials\"});}else{notification.error({message:\"Error\",description:error.message||\"Sorry! Something went wrong. Please try again!\"});}setFacebookLoading(false);});}else{console.log(response);}},{scope:\"email\"});};var onFinish=function onFinish(values){setLoading(true);login(values).then(function(response){localStorage.setItem(\"accessToken\",response.accessToken);props.history.push(\"/chat\");setLoading(false);}).catch(function(error){if(error.status===401){notification.error({message:\"Error\",description:\"Username or Password is incorrect. Please try again!\"});}else{notification.error({message:\"Error\",description:error.message||\"Sorry! Something went wrong. Please try again!\"});}setLoading(false);});};return/*#__PURE__*/React.createElement(\"div\",{className:\"login-container\"},/*#__PURE__*/React.createElement(DingtalkOutlined,{style:{fontSize:50}}),/*#__PURE__*/React.createElement(Form,{name:\"normal_login\",className:\"login-form\",initialValues:{remember:true},onFinish:onFinish},/*#__PURE__*/React.createElement(Form.Item,{name:\"username\",rules:[{required:true,message:\"Please input your Username!\"}]},/*#__PURE__*/React.createElement(Input,{size:\"large\",prefix:/*#__PURE__*/React.createElement(UserOutlined,{className:\"site-form-item-icon\"}),placeholder:\"Username\"})),/*#__PURE__*/React.createElement(Form.Item,{name:\"password\",rules:[{required:true,message:\"Please input your Password!\"}]},/*#__PURE__*/React.createElement(Input,{size:\"large\",prefix:/*#__PURE__*/React.createElement(LockOutlined,{className:\"site-form-item-icon\"}),type:\"password\",placeholder:\"Password\"})),/*#__PURE__*/React.createElement(Form.Item,null,/*#__PURE__*/React.createElement(Button,{shape:\"round\",size:\"large\",htmlType:\"submit\",className:\"login-form-button\",loading:loading},\"Log in\")),/*#__PURE__*/React.createElement(Divider,null,\"OR\"),/*#__PURE__*/React.createElement(Form.Item,null,/*#__PURE__*/React.createElement(Button,{icon:/*#__PURE__*/React.createElement(FacebookFilled,{style:{fontSize:20}}),loading:facebookLoading,className:\"login-with-facebook\",shape:\"round\",size:\"large\",onClick:getFacebookAccessToken},\"Log in With Facebook\")),\"Not a member yet? \",/*#__PURE__*/React.createElement(\"a\",{href:\"/signup\"},\"Sign up\")));};export default Signin;","map":{"version":3,"sources":["/home/abel/Desktop/practice/chat/One-to-One-WebSockets-Chat-master/jwt-social-login-client/src/signin/Signin.js"],"names":["React","useEffect","useState","Form","Input","Button","Divider","notification","UserOutlined","LockOutlined","DingtalkOutlined","FacebookFilled","login","facebookLogin","Signin","props","loading","setLoading","facebookLoading","setFacebookLoading","localStorage","getItem","test","setTest","history","push","initFacebookLogin","window","fbAsyncInit","FB","init","appId","autoLogAppEvents","xfbml","version","getFacebookAccessToken","response","status","facebookLoginRequest","accessToken","authResponse","then","setItem","catch","error","message","description","console","log","scope","onFinish","values","fontSize","remember","required"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Form, Input, Button, Divider, notification } from \"antd\";\nimport {\n  UserOutlined,\n  LockOutlined,\n  DingtalkOutlined,\n  FacebookFilled,\n} from \"@ant-design/icons\";\nimport { login, facebookLogin } from \"../util/ApiUtil\";\nimport \"./Signin.css\";\n\n/*global FB*/\n\nconst Signin = (props) => {\n  const [loading, setLoading] = useState(false);\n  const [facebookLoading, setFacebookLoading] = useState(false);\n  const [test, setTest] = useState(localStorage.getItem(\"accessToken\"));\n\n  useEffect(() => {\n    if (localStorage.getItem(\"accessToken\") !== null) {\n      props.history.push(\"/\");\n    }\n    initFacebookLogin();\n  }, []);\n\n  useEffect(() => {\n    initFacebookLogin();\n  }, [test]);\n\n  const initFacebookLogin = () => {\n    window.fbAsyncInit = function () {\n      FB.init({\n        appId: \"118319422120166\",\n        autoLogAppEvents: true,\n        xfbml: true,\n        version: \"v7.0\",\n      });\n    };\n  };\n\n  const getFacebookAccessToken = () => {\n    setFacebookLoading(true);\n    FB.login(\n      function (response) {\n        if (response.status === \"connected\") {\n          const facebookLoginRequest = {\n            accessToken: response.authResponse.accessToken,\n          };\n          facebookLogin(facebookLoginRequest)\n            .then((response) => {\n              localStorage.setItem(\"accessToken\", response.accessToken);\n              props.history.push(\"/\");\n              setFacebookLoading(false);\n            })\n            .catch((error) => {\n              if (error.status === 401) {\n                notification.error({\n                  message: \"Error\",\n                  description: \"Invalid credentials\",\n                });\n              } else {\n                notification.error({\n                  message: \"Error\",\n                  description:\n                    error.message ||\n                    \"Sorry! Something went wrong. Please try again!\",\n                });\n              }\n              setFacebookLoading(false);\n            });\n        } else {\n          console.log(response);\n        }\n      },\n      { scope: \"email\" }\n    );\n  };\n\n  const onFinish = (values) => {\n    setLoading(true);\n    login(values)\n      .then((response) => {\n        localStorage.setItem(\"accessToken\", response.accessToken);\n        props.history.push(\"/chat\");\n        setLoading(false);\n      })\n      .catch((error) => {\n        if (error.status === 401) {\n          notification.error({\n            message: \"Error\",\n            description: \"Username or Password is incorrect. Please try again!\",\n          });\n        } else {\n          notification.error({\n            message: \"Error\",\n            description:\n              error.message || \"Sorry! Something went wrong. Please try again!\",\n          });\n        }\n        setLoading(false);\n      });\n  };\n\n  return (\n    <div className=\"login-container\">\n      <DingtalkOutlined style={{ fontSize: 50 }} />\n      <Form\n        name=\"normal_login\"\n        className=\"login-form\"\n        initialValues={{ remember: true }}\n        onFinish={onFinish}\n      >\n        <Form.Item\n          name=\"username\"\n          rules={[{ required: true, message: \"Please input your Username!\" }]}\n        >\n          <Input\n            size=\"large\"\n            prefix={<UserOutlined className=\"site-form-item-icon\" />}\n            placeholder=\"Username\"\n          />\n        </Form.Item>\n        <Form.Item\n          name=\"password\"\n          rules={[{ required: true, message: \"Please input your Password!\" }]}\n        >\n          <Input\n            size=\"large\"\n            prefix={<LockOutlined className=\"site-form-item-icon\" />}\n            type=\"password\"\n            placeholder=\"Password\"\n          />\n        </Form.Item>\n        <Form.Item>\n          <Button\n            shape=\"round\"\n            size=\"large\"\n            htmlType=\"submit\"\n            className=\"login-form-button\"\n            loading={loading}\n          >\n            Log in\n          </Button>\n        </Form.Item>\n        <Divider>OR</Divider>\n        <Form.Item>\n          <Button\n            icon={<FacebookFilled style={{ fontSize: 20 }} />}\n            loading={facebookLoading}\n            className=\"login-with-facebook\"\n            shape=\"round\"\n            size=\"large\"\n            onClick={getFacebookAccessToken}\n          >\n            Log in With Facebook\n          </Button>\n        </Form.Item>\n        Not a member yet? <a href=\"/signup\">Sign up</a>\n      </Form>\n    </div>\n  );\n};\n\nexport default Signin;\n"]},"metadata":{},"sourceType":"module"}