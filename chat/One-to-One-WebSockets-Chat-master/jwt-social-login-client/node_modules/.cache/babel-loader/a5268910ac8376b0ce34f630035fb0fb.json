{"ast":null,"code":"var _jsxFileName = \"/home/abel/Desktop/practice/chat/One-to-One-WebSockets-Chat-master/jwt-social-login-client/src/signin/Signin.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { Form, Input, Button, Divider, notification } from \"antd\";\nimport { UserOutlined, LockOutlined, DingtalkOutlined, FacebookFilled } from \"@ant-design/icons\";\nimport { login, facebookLogin } from \"../util/ApiUtil\";\nimport \"./Signin.css\";\n/*global FB*/\n\nconst Signin = props => {\n  const [loading, setLoading] = useState(false);\n  const [facebookLoading, setFacebookLoading] = useState(false);\n  const [test, setTest] = useState(localStorage.getItem(\"accessToken\"));\n  useEffect(() => {\n    if (localStorage.getItem(\"accessToken\") !== null) {\n      props.history.push(\"/\");\n    }\n\n    initFacebookLogin();\n  }, []);\n  useEffect(() => {\n    initFacebookLogin();\n  }, [test]);\n\n  const initFacebookLogin = () => {\n    window.fbAsyncInit = function () {\n      FB.init({\n        appId: \"118319422120166\",\n        autoLogAppEvents: true,\n        xfbml: true,\n        version: \"v7.0\"\n      });\n    };\n  };\n\n  const getFacebookAccessToken = () => {\n    setFacebookLoading(true);\n    FB.login(function (response) {\n      if (response.status === \"connected\") {\n        const facebookLoginRequest = {\n          accessToken: response.authResponse.accessToken\n        };\n        facebookLogin(facebookLoginRequest).then(response => {\n          localStorage.setItem(\"accessToken\", response.accessToken);\n          props.history.push(\"/\");\n          setFacebookLoading(false);\n        }).catch(error => {\n          if (error.status === 401) {\n            notification.error({\n              message: \"Error\",\n              description: \"Invalid credentials\"\n            });\n          } else {\n            notification.error({\n              message: \"Error\",\n              description: error.message || \"Sorry! Something went wrong. Please try again!\"\n            });\n          }\n\n          setFacebookLoading(false);\n        });\n      } else {\n        console.log(response);\n      }\n    }, {\n      scope: \"email\"\n    });\n  };\n\n  const onFinish = values => {\n    setLoading(true);\n    login(values).then(response => {\n      localStorage.setItem(\"accessToken\", response.accessToken);\n      props.history.push(\"/chat\");\n      setLoading(false);\n    }).catch(error => {\n      if (error.status === 401) {\n        notification.error({\n          message: \"Error\",\n          description: \"Username or Password is incorrect. Please try again!\"\n        });\n      } else {\n        notification.error({\n          message: \"Error\",\n          description: error.message || \"Sorry! Something went wrong. Please try again!\"\n        });\n      }\n\n      setLoading(false);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(DingtalkOutlined, {\n    style: {\n      fontSize: 50\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Form, {\n    name: \"normal_login\",\n    className: \"login-form\",\n    initialValues: {\n      remember: true\n    },\n    onFinish: onFinish,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Form.Item, {\n    name: \"username\",\n    rules: [{\n      required: true,\n      message: \"Please input your Username!\"\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    size: \"large\",\n    prefix: /*#__PURE__*/React.createElement(UserOutlined, {\n      className: \"site-form-item-icon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 21\n      }\n    }),\n    placeholder: \"Username\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    name: \"password\",\n    rules: [{\n      required: true,\n      message: \"Please input your Password!\"\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    size: \"large\",\n    prefix: /*#__PURE__*/React.createElement(LockOutlined, {\n      className: \"site-form-item-icon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 21\n      }\n    }),\n    type: \"password\",\n    placeholder: \"Password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Form.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    shape: \"round\",\n    size: \"large\",\n    htmlType: \"submit\",\n    className: \"login-form-button\",\n    loading: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 11\n    }\n  }, \"Log in\")), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 9\n    }\n  }, \"OR\"), /*#__PURE__*/React.createElement(Form.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    icon: /*#__PURE__*/React.createElement(FacebookFilled, {\n      style: {\n        fontSize: 20\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 19\n      }\n    }),\n    loading: facebookLoading,\n    className: \"login-with-facebook\",\n    shape: \"round\",\n    size: \"large\",\n    onClick: getFacebookAccessToken,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 11\n    }\n  }, \"Log in With Facebook\")), \"Not a member yet? \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"/signup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 27\n    }\n  }, \"Sign up\")));\n};\n\nexport default Signin;","map":{"version":3,"sources":["/home/abel/Desktop/practice/chat/One-to-One-WebSockets-Chat-master/jwt-social-login-client/src/signin/Signin.js"],"names":["React","useEffect","useState","Form","Input","Button","Divider","notification","UserOutlined","LockOutlined","DingtalkOutlined","FacebookFilled","login","facebookLogin","Signin","props","loading","setLoading","facebookLoading","setFacebookLoading","test","setTest","localStorage","getItem","history","push","initFacebookLogin","window","fbAsyncInit","FB","init","appId","autoLogAppEvents","xfbml","version","getFacebookAccessToken","response","status","facebookLoginRequest","accessToken","authResponse","then","setItem","catch","error","message","description","console","log","scope","onFinish","values","fontSize","remember","required"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Form, Input, Button, Divider, notification } from \"antd\";\nimport {\n  UserOutlined,\n  LockOutlined,\n  DingtalkOutlined,\n  FacebookFilled,\n} from \"@ant-design/icons\";\nimport { login, facebookLogin } from \"../util/ApiUtil\";\nimport \"./Signin.css\";\n\n/*global FB*/\n\nconst Signin = (props) => {\n  const [loading, setLoading] = useState(false);\n  const [facebookLoading, setFacebookLoading] = useState(false);\n  const [test, setTest] = useState(localStorage.getItem(\"accessToken\"));\n\n  useEffect(() => {\n    if (localStorage.getItem(\"accessToken\") !== null) {\n      props.history.push(\"/\");\n    }\n    initFacebookLogin();\n  }, []);\n\n  useEffect(() => {\n    initFacebookLogin();\n  }, [test]);\n\n  const initFacebookLogin = () => {\n    window.fbAsyncInit = function () {\n      FB.init({\n        appId: \"118319422120166\",\n        autoLogAppEvents: true,\n        xfbml: true,\n        version: \"v7.0\",\n      });\n    };\n  };\n\n  const getFacebookAccessToken = () => {\n    setFacebookLoading(true);\n    FB.login(\n      function (response) {\n        if (response.status === \"connected\") {\n          const facebookLoginRequest = {\n            accessToken: response.authResponse.accessToken,\n          };\n          facebookLogin(facebookLoginRequest)\n            .then((response) => {\n              localStorage.setItem(\"accessToken\", response.accessToken);\n              props.history.push(\"/\");\n              setFacebookLoading(false);\n            })\n            .catch((error) => {\n              if (error.status === 401) {\n                notification.error({\n                  message: \"Error\",\n                  description: \"Invalid credentials\",\n                });\n              } else {\n                notification.error({\n                  message: \"Error\",\n                  description:\n                    error.message ||\n                    \"Sorry! Something went wrong. Please try again!\",\n                });\n              }\n              setFacebookLoading(false);\n            });\n        } else {\n          console.log(response);\n        }\n      },\n      { scope: \"email\" }\n    );\n  };\n\n  const onFinish = (values) => {\n    setLoading(true);\n    login(values)\n      .then((response) => {\n        localStorage.setItem(\"accessToken\", response.accessToken);\n        props.history.push(\"/chat\");\n        setLoading(false);\n      })\n      .catch((error) => {\n        if (error.status === 401) {\n          notification.error({\n            message: \"Error\",\n            description: \"Username or Password is incorrect. Please try again!\",\n          });\n        } else {\n          notification.error({\n            message: \"Error\",\n            description:\n              error.message || \"Sorry! Something went wrong. Please try again!\",\n          });\n        }\n        setLoading(false);\n      });\n  };\n\n  return (\n    <div className=\"login-container\">\n      <DingtalkOutlined style={{ fontSize: 50 }} />\n      <Form\n        name=\"normal_login\"\n        className=\"login-form\"\n        initialValues={{ remember: true }}\n        onFinish={onFinish}\n      >\n        <Form.Item\n          name=\"username\"\n          rules={[{ required: true, message: \"Please input your Username!\" }]}\n        >\n          <Input\n            size=\"large\"\n            prefix={<UserOutlined className=\"site-form-item-icon\" />}\n            placeholder=\"Username\"\n          />\n        </Form.Item>\n        <Form.Item\n          name=\"password\"\n          rules={[{ required: true, message: \"Please input your Password!\" }]}\n        >\n          <Input\n            size=\"large\"\n            prefix={<LockOutlined className=\"site-form-item-icon\" />}\n            type=\"password\"\n            placeholder=\"Password\"\n          />\n        </Form.Item>\n        <Form.Item>\n          <Button\n            shape=\"round\"\n            size=\"large\"\n            htmlType=\"submit\"\n            className=\"login-form-button\"\n            loading={loading}\n          >\n            Log in\n          </Button>\n        </Form.Item>\n        <Divider>OR</Divider>\n        <Form.Item>\n          <Button\n            icon={<FacebookFilled style={{ fontSize: 20 }} />}\n            loading={facebookLoading}\n            className=\"login-with-facebook\"\n            shape=\"round\"\n            size=\"large\"\n            onClick={getFacebookAccessToken}\n          >\n            Log in With Facebook\n          </Button>\n        </Form.Item>\n        Not a member yet? <a href=\"/signup\">Sign up</a>\n      </Form>\n    </div>\n  );\n};\n\nexport default Signin;\n"]},"metadata":{},"sourceType":"module"}